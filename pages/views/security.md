## e. Представление безопасности

**Цель**: Показать, как реализованы меры безопасности для защиты системы и данных.

**Для кого**: CISO, команда безопасности, разработчики.

**Многоуровневая модель безопасности:**
1. Периметр и доступ (Perimeter & Access):
* API Gateway: Единая точка входа. Реализует WAF (Web Application Firewall) и Rate Limiting.
* Auth Service (Keycloak): Централизованная аутентификация (OAuth 2.0/OIDC), выдача JWT-токенов с коротким временем жизни (15 мин).
* Монолит/Сервисы: Проверяют JWT на валидность и scope для каждого входящего запроса.
2. Защита данных (Data Protection):
* В покое: Шифрование томов БД (AWS KMS). Шифрование чувствительных полей (PII) на уровне приложения перед записью в БД.
* При передаче: Обязательное использование TLS 1.3 для всех внешних и внутренних коммуникаций (mTLS для сервис-сервис в будущем).
*& Секреты: Хранение в Vault, ротация ключей.
3. Безопасность приложения (Application Security):
* Валидация входных данных на всех уровнях (API, бизнес-логика).
* Принцип наименьших привилегий для сервисных аккаунтов и ролей в БД.
* Регулярное сканирование зависимостей (SAST/DAST) в CI/CD пайплайне.
4. Аудит и мониторинг (Audit & Monitoring):
* Логи аудита: Все критические действия (логин, смена пароля, отзыв согласия) логируются в неизменяемое хранилище (управляемый S3 с versioning).
* Мониторинг аномалий: Алёрты на подозрительную активность (много неудачных логинов, запросы из необычных регионов).
5. Compliance (GDPR/CCPA):
* Consent Service: Хранит историю согласий. При отзыве — триггерит процесс удаления/анонимизации данных.
* Data Deletion Pipeline: Отдельный фоновый процесс для выполнения NFR-SEC-4: находит все данные пользователя по user_id в разных системах (PostgreSQL, S3, Kafka topics, ClickHouse) и удаляет/анонимизирует их.

**Угрозы и митигация**: Защита от OWASP Top 10 через WAF и secure coding practices. Защита от инсайдеров через разделение ролей и аудит.
